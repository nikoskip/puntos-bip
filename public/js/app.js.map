{"version":3,"sources":["app.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["var PuntosBip = (function () {\r\n\r\n    'use strict';\r\n\r\n    /**\r\n     * Puntos Bip! obtenidos de la búsqueda\r\n     */\r\n    var _records;\r\n\r\n    /**\r\n     * Listado DOM de resultados\r\n     */\r\n    var _$resultList;\r\n\r\n    /**\r\n     * Boton que realiza la búsqueda\r\n     */\r\n    var _$searchButton;\r\n\r\n    var _init = function () {\r\n        _$resultList = $('#result-list');\r\n        _$searchButton = $('#search');\r\n\r\n        _$searchButton.click(_searchHandler);\r\n    };\r\n\r\n    /**\r\n     * Handler para botón de búsqueda\r\n     * @param e\r\n     * @private\r\n     */\r\n    var _searchHandler = function (e) {\r\n        var address = $.trim($('#address').val());\r\n\r\n        if (address === '') {\r\n            alert('Por favor ingresa una dirección');\r\n            return;\r\n        }\r\n\r\n        _$resultList.css('opacity', 0.1);\r\n\r\n        // Deshabilitamos el botón\r\n        _disableButton();\r\n\r\n        $.when(_find(address)).then(function (data) {\r\n            _records = data.results;\r\n            $('#results-info').text('Se encontraron ' + data.results.length + ' Puntos Bip!');\r\n            // Limpaimos resultados por si existen previamente\r\n            _clearResults();\r\n            // Listamos resultados\r\n            _listResults();\r\n            // Habilitamos el botón\r\n            _activateButton();\r\n        }, function () {\r\n            // Habilitamos el botón\r\n            _activateButton();\r\n            alert('Algo sucedió al obtener los resultados. Vuelve a intentarlo.')\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Busca los Puntos Bip! para una dirección dada\r\n     * @param address\r\n     * @returns {*}\r\n     * @private\r\n     */\r\n    var _find = function (address) {\r\n        return $.getJSON('/api/getByAddress', {address: address});\r\n    };\r\n\r\n    /**\r\n     * Lista los resultados\r\n     * @private\r\n     */\r\n    var _listResults = function () {\r\n        var templateContent = $('#template-record').html();\r\n        $.each(_records, function () {\r\n            var template = _.template(templateContent);\r\n            _$resultList.append(template(this));\r\n        });\r\n        _$resultList.css('opacity', 1);\r\n        $('#results').show();\r\n    };\r\n\r\n    /**\r\n     * Elimina todos los resultados en pantalla\r\n     * @private\r\n     */\r\n    var _clearResults = function () {\r\n        _$resultList.find('li').remove();\r\n    };\r\n\r\n    var _disableButton = function (){\r\n        _$searchButton.prop('disabled', true).html('<span>||</span><span>||</span><span>||</span>').addClass('saving');\r\n    };\r\n\r\n    var _activateButton = function () {\r\n        _$searchButton.prop('disabled', false).text('Buscar').removeClass('saving');\r\n    }\r\n\r\n    return {\r\n        init: _init\r\n    }\r\n\r\n})();\r\n\r\n$(function () {\r\n    PuntosBip.init();\r\n});"],"sourceRoot":"/source/"}